var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,s=(e,t)=>{for(var o in t||(t={}))l.call(t,o)&&a(e,o,t[o]);if(n)for(var o of n(t))i.call(t,o)&&a(e,o,t[o]);return e},r=(e,n)=>t(e,o(n));import{r as c,j as u,k as d,P as g,l as v,m as f,E as b}from"./index.2f75c821.js";import{V as m,r as p,O as y,a0 as x,Q as w,E as h,A as k,B as C,H as L,T as B,t as O,d as P,i as A,a5 as j,f as T}from"./vue.8a0c43f5.js";let $;const V=function(e={}){if(!u)return;const t=E(e);t.fullscreen&&$&&($.remvoeElLoadingChild(),$.close());const o=function(e){let t;const o=p(!1),n=y(r(s({},e),{originalPosition:"",originalOverflow:"",visible:!1}));function l(){const e=n.parent;if(!e.vLoadingAddClassList){let t=e.getAttribute("loading-number");t=Number.parseInt(t)-1,t?e.setAttribute("loading-number",t.toString()):(c(e,"el-loading-parent--relative"),e.removeAttribute("loading-number")),c(e,"el-loading-parent--hidden")}i()}function i(){var e,t;null==(t=null==(e=u.$el)?void 0:e.parentNode)||t.removeChild(u.$el)}function a(){o.value&&(o.value=!1,l())}const u=x({name:"ElLoading",setup:()=>()=>{const e=n.spinner||n.svg,t=w("svg",s({class:"circular",viewBox:n.svgViewBox?n.svgViewBox:"25 25 50 50"},e?{innerHTML:e}:{}),[w("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none"})]),o=n.text?w("p",{class:"el-loading-text"},[n.text]):void 0;return w(B,{name:"el-loading-fade",onAfterLeave:a},{default:h((()=>[k(L("div",{style:{backgroundColor:n.background||""},class:["el-loading-mask",n.customClass,n.fullscreen?"is-fullscreen":""]},[w("div",{class:"el-loading-spinner"},[t,o])]),[[C,n.visible]])]))})}}).mount(document.createElement("div"));return r(s({},m(n)),{setText:function(e){n.text=e},remvoeElLoadingChild:i,close:function(){var i;e.beforeClose&&!e.beforeClose()||(n.parent.vLoadingAddClassList=void 0,o.value=!0,clearTimeout(t),t=window.setTimeout((()=>{o.value&&(o.value=!1,l())}),400),n.visible=!1,null==(i=e.closed)||i.call(e))},handleAfterLeave:a,vm:u,get $el(){return u.$el}})}(r(s({},t),{closed:()=>{var e;null==(e=t.closed)||e.call(t),t.fullscreen&&($=void 0)}}));I(t,t.parent,o),S(t,t.parent,o),t.parent.vLoadingAddClassList=()=>S(t,t.parent,o);let n=t.parent.getAttribute("loading-number");return n=n?`${Number.parseInt(n)+1}`:"1",t.parent.setAttribute("loading-number",n),t.parent.appendChild(o.$el),O((()=>o.visible.value=t.visible)),t.fullscreen&&($=o),o},E=e=>{var t,o,n,l;let i;return i=P(e.target)?null!=(t=document.querySelector(e.target))?t:document.body:e.target||document.body,{parent:i===document.body||e.body?document.body:i,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:i===document.body&&(null==(o=e.fullscreen)||o),lock:null!=(n=e.lock)&&n,customClass:e.customClass||"",visible:null==(l=e.visible)||l,target:i}},I=async(e,t,o)=>{const n={};if(e.fullscreen)o.originalPosition.value=d(document.body,"position"),o.originalOverflow.value=d(document.body,"overflow"),n.zIndex=g.nextZIndex();else if(e.parent===document.body){o.originalPosition.value=d(document.body,"position"),await O();for(const t of["top","left"]){const o="top"===t?"scrollTop":"scrollLeft";n[t]=e.target.getBoundingClientRect()[t]+document.body[o]+document.documentElement[o]-parseInt(d(document.body,`margin-${t}`),10)+"px"}for(const t of["height","width"])n[t]=`${e.target.getBoundingClientRect()[t]}px`}else o.originalPosition.value=d(t,"position");for(const[l,i]of Object.entries(n))o.$el.style[l]=i},S=(e,t,o)=>{"absolute"!==o.originalPosition.value&&"fixed"!==o.originalPosition.value?v(t,"el-loading-parent--relative"):c(t,"el-loading-parent--relative"),e.fullscreen&&e.lock?v(t,"el-loading-parent--hidden"):c(t,"el-loading-parent--hidden")},N=Symbol("ElLoading"),z=(e,t)=>{var o,n,l,i;const a=t.instance,s=e=>A(t.value)?t.value[e]:void 0,r=t=>(e=>{const t=P(e)&&(null==a?void 0:a[e])||e;return t?p(t):t})(s(t)||e.getAttribute(`element-loading-${j(t)}`)),c=null!=(o=s("fullscreen"))?o:t.modifiers.fullscreen,u={text:r("text"),svg:r("svg"),svgViewBox:r("svgViewBox"),spinner:r("spinner"),background:r("background"),customClass:r("customClass"),fullscreen:c,target:null!=(n=s("target"))?n:c?void 0:e,body:null!=(l=s("body"))?l:t.modifiers.body,lock:null!=(i=s("lock"))?i:t.modifiers.lock};e[N]={options:u,instance:V(u)}},G={mounted(e,t){t.value&&z(e,t)},updated(e,t){const o=e[N];t.oldValue!==t.value&&(t.value&&!t.oldValue?z(e,t):t.value&&t.oldValue?A(t.value)&&((e,t)=>{for(const o of Object.keys(t))T(t[o])&&(t[o].value=e[o])})(t.value,o.options):null==o||o.instance.close())},unmounted(e){var t;null==(t=e[N])||t.instance.close()}},H={install(e){e.directive("loading",G),e.config.globalProperties.$loading=V},directive:G,service:V};var M=()=>{let e=p(!0);return{showGlobalLoading:function(){e=H.service({lock:!0,text:"加载中...",background:"rgba(255, 255, 255, 0.7)"})},hideGlobalLoading:function(){setTimeout((()=>{e.close()}),1e3)},showMessageBox:function(e,t,o,n,l){f.confirm(o,e,{confirmButtonText:"确认",cancelButtonText:"取消",center:!0,"round-button":!1,"button-size":"default","close-on-click-modal":!1,"show-cancel-button":n,"show-confirm-button":l,type:t,beforeClose:(e,t,o)=>{"confirm"===e?(t.confirmButtonLoading=!0,t.confirmButtonText="正在删除中...",setTimeout((()=>{o(),t.confirmButtonLoading=!1}),3e3)):o()}}).then((e=>{b({type:"success",message:"删除成功"})})).catch((()=>{b({type:"info",message:"已取消"})}))}}};export{M as h};
